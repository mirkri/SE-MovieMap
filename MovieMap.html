<!doctype html>
<!-- The DOCTYPE declaration above will set the     -->
<!-- browser's rendering engine into                -->
<!-- "Standards Mode". Replacing this declaration   -->
<!-- with a "Quirks Mode" doctype is not supported. -->

<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">

    <!--                                                               -->
    <!-- Consider inlining CSS to reduce the number of requested files -->
    <!--                                                               -->
    <link type="text/css" rel="stylesheet" href="MovieMap.css">
    <link media="all" type="text/css" href="jquery-ui.css" rel="stylesheet"> 
    <script src="jquery-1.4.4.min.js" type="text/javascript" charset="utf-8"></script> 
    <script src="jquery-ui.min.js" type="text/javascript" charset="utf-8"></script>
    
    <script src="jquery.plugin.html2canvas.js"></script>
	<script src="base64.js"></script>    
	<script src="html2canvas.js"></script>
	<script src="canvas2image.js"></script>
    <script src="exportCSV.js" type="text/javascript" charset="utf-8"></script>
    <script src="exportPNG.js" type="text/javascript" charset="utf-8"></script>
    

    <!--                                           -->
    <!-- Any title is fine                         -->
    <!--                                           -->
    <title>MovieMap</title>
    
    <!--                                           -->
    <!-- This script loads your compiled module.   -->
    <!-- If you add any GWT meta tags, they must   -->
    <!-- be added before this line.                -->
    <!--                                           -->
    <script type="text/javascript" language="javascript" src="moviemap/moviemap.nocache.js"></script>
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript">
    
    // Variables available from MovieMap.java
    // 
    // countries[] , Array[String] 
    // Holds all country-names that should be included in the GeoChart
    //
    // moviesPerCountry[] , Array[Int]
    // Holds the number of movies for the country with the same Array-Index
    //
    
    function onGwtReady() {
    	
		var items = [['Country', 'Movies']];
		
		//alert(countries);
		
		// If one array is shorter than the other, the function  
		// would iterate over the shorter one to avoid an exception
		
    	var arrayLength = 0;
    	if (countries.length <= moviesPerCountry.length) {
	    	arrayLength = countries.length;
    	} else {
	    	arrayLength = moviesPerCountry.length;
    	}
    	
    	// Fills the GeoChart-table
    	for (i = 0; i < arrayLength; i++) {
		  	items.push([countries[i],moviesPerCountry[i]]);
    	}
		
    	var data = google.visualization.arrayToDataTable(items);
    	
    	var options = {
	    	width: 1193,
	    	height: 500,
	    	colorAxis: {colors: ['#55606e', '#24afb2']},
	    	backgroundColor: '#f7f7f7',
	    	datalessRegionColor: '#343a41'
    	};
		
		var my_div = document.getElementById('regions_div');
    	var chart = new google.visualization.GeoChart(document.getElementById('regions_div'));
    	
    	google.visualization.events.addListener(chart, 'ready', function () {
        	document.getElementById('png').outerHTML = '<a id="png" href="' + chart.getImageURI() + '">Export to PNG</a>';
      	});
    	
    	chart.draw(data, options);
    	
    };
    
    google.load("visualization", "1", {packages:["geochart"]});
	google.setOnLoadCallback(onGwtReady); 	  
	
	
      
    </script>
    
  </head>

  <!--                                           -->
  <!-- The body can have arbitrary html, or      -->
  <!-- you can leave the body empty if you want  -->
  <!-- to create a completely dynamic UI.        -->
  <!--                                           -->
  <body class="body">

    <!-- OPTIONAL: include this if you want history support -->
    <iframe src="javascript:''" id="__gwt_historyFrame" tabIndex='-1' style="position:absolute;width:0;height:0;border:0"></iframe>
    
    <!-- RECOMMENDED if your web app will not function without JavaScript enabled -->
    <noscript>
      <div style="width: 22em; position: absolute; left: 50%; margin-left: -11em; color: red; background-color: white; border: 1px solid red; padding: 4px; font-family: sans-serif">
        Your web browser must have JavaScript enabled
        in order for this application to display correctly.
      </div>
    </noscript>
	
	<div id="wrapperOne" style="width: auto;">
		<div id="rootDropdown" class="Dropdown"></div>
	</div>
	<div id="wrapperOne" style="width: auto; margin-top:40px;">
		<div id="rootSearch" class="Search"></div>
	</div>
	
	<div id="wrapperOne" style="width: 85%; margin: auto; margin-top:20px; height: 682px;">
		<div id="wrapperOne" style="width: auto; background-color: #e9e9e9; height: 40px;">
			<a href="/upload" class="uploadLink">Upload to Database</a>
			<button id= "Showtable-button" style="float:right" class="gwt-Button" >Table</button>
			<button id= "Showmap-button" style="float:right" class="gwt-Button2" >Map</button>
		</div>
		<div id="wrapperOne" style="width: auto; background-color: #f7f7f7; height: 535px; border: 1px solid #acacac; margin-top: -1px;">
			<div id="regions_div" style="display: initial; background-color: #f7f7f7;position: absolute;" class="Map"></div>
			<div id="headerTable" style="display:none; margin-left: -1px; margin-right: -2px;"></div>
			<div id="root123" style="float: left;display: none; width: 1193px; height: auto; max-height: 500px;overflow: auto;position: absolute;" class="Table"></div>
		</div>
		<div id="wrapperOne" style="height: 105px; background-color: #e9e9e9; border: 1px solid #acacac; margin-top: -1px;"> 
			
			<div id="csv" style="display: none" class="exportCsv"><a href="#" style="color: white;" role='button'>Export to CSV</a></div>
			<div id='png'></div>
			
			<div id="title"></div>
			<div id="value" style="float:left;width:78%; height:auto;margin-top: 15px;"></div>
			<div id="rootNavigation" style="float: left;" class="Navigation"></div>
		</div>
	</div>
	<div id="wrapperOne" style="width: 85%; margin: auto; height: 70px;">
		<div id="advertisement">YOUR ADVERTISEMENT HERE</div>
		
		<div class="cc">
			<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/" style="float: right;">
				<img alt="Creative Commons Lizenzvertrag" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" />
	    	</a>
			<span xmlns:dct="http://purl.org/dc/terms/" href="http://purl.org/dc/dcmitype/Dataset" property="dct:title" rel="dct:type" style="float:right;"></span>MovieMap von Urheber ist lizenziert unter einer 
			<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/" style="color: #55606e !important; text-decoration: underline;">Creative Commons Namensnennung - Weitergabe 			unter gleichen Bedingungen 4.0 International Lizenz
			</a>.
    </div>
	</div>
    
	<!--<div style="float:left;"><h1>MovieMap</h1></div>
	<img style="float:right; width: 400px; height: 200px;" src="/banner.gif" />
	<a href="/upload">Click here to update the database</a>
	-->

  
  <script>
	  
	$("div.Map").show("fast");
    $("div.exportPng").show("fast");
    
  	$("#Showtable-button").click(function () {
		document.getElementById("Showtable-button").className = "gwt-Button2";
		document.getElementById("Showmap-button").className = "gwt-Button";
		
    	$("div.Table").fadeTo("fast",1.00);
    	$("#headerTable").fadeTo("fast",1.00);
    	$("div.Map").fadeTo("fast",0.00);
    	
    	$("#csv").show("slow"); 
    	$("#png").hide("slow");
    });

	$("#Showmap-button").click(function () {	
		document.getElementById("Showtable-button").className = "gwt-Button";
		document.getElementById("Showmap-button").className = "gwt-Button2";
		
    	$("div.Map").fadeTo("fast",1.00);
    	$("#headerTable").fadeTo("fast",0.00);
    	$("div.Table").fadeTo("fast",0.00);
    	
    	$("#png").show("slow");
    	$("#csv").hide("slow");
    });
	</script>
	
  </body>
</html>
